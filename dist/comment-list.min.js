/*! comment-list 25-07-2017 */
"use strict";!function(a){function b(a,b,c){function d(){n.innerHTML="",a.forEach(function(a){if(i=new commentListUtils.Element("div","clear"),h=new commentListUtils.LikesDislikes(a,b,c),g=new commentListUtils.ImageContainer(a.userImageUrl,"user-image",b),e=new commentListUtils.Element("div","comment-block"),f=new commentListUtils.Element("div","children-comments"),j=new commentListUtils.Element("span","user-name",b.userLinkFormatter(a.userName)),k=new commentListUtils.Element("span","comment-time",commentListUtils.timeSince(a.time)),l=new commentListUtils.Element("div","content",a.content),m=new commentListUtils.ReplySection(b,a,d),e.appendChild(g),e.appendChild(j),e.appendChild(k),e.appendChild(l),e.appendChild(h),b.maxLevelDown>=c&&e.appendChild(m),e.appendChild(i),a.children&&a.children.length){var o=new commentListUtils.Comment(a.children,b,c+1);f.appendChild(o)}e.appendChild(f),n.appendChild(e)})}var e,f,g,h,i,j,k,l,m,n=new commentListUtils.Element("div");return d(),n}void 0===a.commentListUtils&&(a.commentListUtils={}),a.commentListUtils.Comment=b}(window),function(a){function b(a,b,c,d){var e=document.createElement(a||"div");if(b){b.split(" ").forEach(function(a){e.classList.add(a)})}return e.innerHTML=c||"",d&&d.length&&d.forEach(function(a){e.setAttribute(a.key,a.value)}),e}void 0===a.commentListUtils&&(a.commentListUtils={}),a.commentListUtils.Element=b}(window),function(a){function b(a,b,c){return new commentListUtils.Element("img",b,"",[{key:"src",value:a||c.standardImage}])}void 0===a.commentListUtils&&(a.commentListUtils={}),a.commentListUtils.ImageContainer=b}(window),function(a){function b(a,b,c){this.list=a,this.element=b,this.config=Object.assign({standardImage:"images/test-user.png",noUserImage:"images/no-name-user.png",inputPlaceHolder:"Join the discussion",replyPlaceHolder:"Enter reply",maxLevelDown:2,userLinkFormatter:function(a){return a}},c)}function c(a,b){a.querySelector(".input-section").addEventListener("keypress",function(a){13==a.which&&"function"==typeof b&&b(a)})}b.prototype.destroy=function(){this.element.innerHTML=""},b.prototype.render=function(){var a=this,b=this.config,d=new commentListUtils.Comment(this.list,b,1),e=new commentListUtils.InputSection(b),f=new commentListUtils.Element("div","comments-widget");this.element.appendChild(f);var g=new commentListUtils.Element("div","input-container");g.append(e),f.appendChild(g),g=new commentListUtils.Element("div","comment-list-container"),g.appendChild(d),f.appendChild(g),c(f,function(c){var d=c.target.value;(d=d.trim())&&("function"==typeof b.submitAPIHandler?b.submitAPIHandler({content:d}).then(function(b){a.list.unshift(b),a.destroy(),a.render()}):console.log("Don't know what to do with this comment"))})},a.commentList=function(a,c,d){return new b(a,c,d)}}(window),function(a){function b(a){var b=new commentListUtils.Element("div"),c=new commentListUtils.ImageContainer(a.noUserImage,"user-image"),d=new commentListUtils.Element("input","input-section","",[{key:"placeholder",value:a.inputPlaceHolder}]),e=new commentListUtils.Element("div","clear");return b.appendChild(c),b.appendChild(d),b.appendChild(e),b}void 0===a.commentListUtils&&(a.commentListUtils={}),a.commentListUtils.InputSection=b}(window),function(a){function b(a,b,c){function d(){k.innerHTML="";var d=new commentListUtils.Element("span","like"===a.yourLike?"liked":"like",(a.likes||0)+" - "+("like"===a.yourLike?"Liked":"Like")),e=new commentListUtils.Element("span","dislike"===a.yourLike?"disliked":"dislike",(a.dislikes||0)+" - "+("dislike"===a.yourLike?"Disliked":"Dislike")),f=new commentListUtils.Element("span","reply","Reply"),g=new commentListUtils.Element("span","share","Share");k.appendChild(d),k.appendChild(e),b.maxLevelDown>=c&&k.appendChild(f),k.appendChild(g)}function e(){b.likeHandler?b.likeHandler(a).then(function(b){a=Object.assign(a,b),d()}):console.log("likeHandler not registered")}function f(){b.dislikeHandler?b.dislikeHandler(a).then(function(b){a=Object.assign(a,b),d()}):console.log("dislikeHandler not registered")}function g(){b.revertLikeHandler?b.revertLikeHandler(a).then(function(b){a=Object.assign(a,b),d()}):console.log("revertLikeHandler not registered")}function h(){b.revertDislikeHandler?b.revertDislikeHandler(a).then(function(b){a=Object.assign(a,b),d()}):console.log("revertDislikeHandler not registered")}function i(a){commentListUtils.findAncestor(a.target,"comment-block").querySelector(".reply-container").classList.remove("hide")}function j(){k.addEventListener("click",function(b){switch(b.target.className){case"share":var c=new CustomEvent("share-post",{detail:a});document.dispatchEvent(c);break;case"like":e();break;case"dislike":f();break;case"liked":g();break;case"disliked":h();break;case"reply":i(b)}})}var k=new commentListUtils.Element("div","like-dislike-container");return j(),d(),k}void 0===a.commentListUtils&&(a.commentListUtils={}),a.commentListUtils.LikesDislikes=b}(window),function(a){function b(a,b,c){var d=new commentListUtils.Element("div","reply-container hide"),e=new commentListUtils.Element("input","","",[{key:"type",value:"text"},{key:"placeholder",value:a.replyPlaceHolder}]),f=function(d){var e=d.target.value;"function"==typeof a.replyCommentHandler?a.replyCommentHandler({parentId:b.id,content:e}).then(function(a){b.children.unshift(a),c()}):console.log("revertDislikeHandler not registered")};return d.appendChild(e),e.addEventListener("keypress",function(a){13==a.which&&f(a)}),d}void 0===a.commentListUtils&&(a.commentListUtils={}),a.commentListUtils.ReplySection=b}(window),function(a){function b(a){var b=Math.floor((new Date-a)/1e3),c=Math.floor(b/31536e3);if(c>1)return c+" years ago";if((c=Math.floor(b/2592e3))>1)return c+" months ago";if((c=Math.floor(b/86400))>1)return c+" days ago";if((c=Math.floor(b/3600))>1)return c+" hours ago";if((c=Math.floor(b/60))>1)return c+" minutes ago";var d=Math.floor(b);return d<5?"Just now":d<15?"a few seconds ago":d+" seconds ago"}function c(a,b){for(;(a=a.parentElement)&&!a.classList.contains(b););return a}void 0===a.commentListUtils&&(a.commentListUtils={}),a.commentListUtils.timeSince=b,a.commentListUtils.findAncestor=c}(window);