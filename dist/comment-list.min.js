/*! comment-list 25-07-2017 */
"use strict";!function(a){function b(a,b,c){this.list=a,this.element=b,this.config=Object.assign({standardImage:"images/test-user.png",noUserImage:"images/no-name-user.png",inputPlaceHolder:"Join the discussion",userLinkFormatter:function(a){return a}},c)}function c(a,b,c,d){var e=document.createElement(a||"div");return b&&e.classList.add(b),e.innerHTML=c||"",d&&d.length&&d.forEach(function(a){e.setAttribute(a.key,a.value)}),e}function d(a){var b=new c("div"),d=new e(a.noUserImage,"user-image"),f=new c("input","input-section","",[{key:"placeholder",value:a.inputPlaceHolder}]),g=new c("div","clear");return b.appendChild(d),b.appendChild(f),b.appendChild(g),b}function e(a,b,d){return new c("img",b,"",[{key:"src",value:a||d.standardImage}])}function f(a,b){function d(){e.innerHTML="";var b=new c("span","like"===a.yourLike?"liked":"like",(a.likes||0)+" - "+("like"===a.yourLike?"liked":"like")),d=new c("span","dislike"===a.yourLike?"disliked":"dislike",(a.dislikes||0)+" - "+("dislike"===a.yourLike?"disliked":"dislike")),f=new c("span","reply","Reply"),g=new c("span","share","Share");e.appendChild(b),e.appendChild(d),e.appendChild(f),e.appendChild(g)}var e=new c("div","like-dislike-container");return d(),e.addEventListener("click",function(c){switch(c.target.className){case"share":var e=new CustomEvent("share-post",{detail:a});document.dispatchEvent(e);break;case"like":b.likeHandler?b.likeHandler(a).then(function(b){a=Object.assign(a,b),d()}):console.log("likeHandler not registered");break;case"dislike":b.dislikeHandler?b.dislikeHandler(a).then(function(b){a=Object.assign(a,b),d()}):console.log("dislikeHandler not registered");break;case"liked":b.revertLikeHandler?b.revertLikeHandler(a).then(function(b){a=Object.assign(a,b),d()}):console.log("revertLikeHandler not registered");break;case"disliked":b.revertDislikeHandler?b.revertDislikeHandler(a).then(function(b){a=Object.assign(a,b),d()}):console.log("revertDislikeHandler not registered")}}),e}function g(a,b){var d,h,i,j,k,l,m,n,o=new c("div");return a.forEach(function(a){if(k=new c("div","clear"),j=new f(a,b),i=new e(a.userImageUrl,"user-image",b),d=new c("div","comment-block"),h=new c("div","children-comments"),l=new c("span","user-name",b.userLinkFormatter(a.userName)),m=new c("span","comment-time",commentListUtils.timeSince(a.time)),n=new c("div","content",a.content),d.appendChild(i),d.appendChild(l),d.appendChild(m),d.appendChild(n),d.appendChild(j),d.appendChild(k),a.children&&a.children.length){var p=new g(a.children,b);h.appendChild(p)}d.appendChild(h),o.appendChild(d)}),o}function h(a,b){a.querySelector(".input-section").addEventListener("keypress",function(a){13==a.which&&"function"==typeof b&&b(a)})}b.prototype.destroy=function(){this.element.innerHTML=""},b.prototype.render=function(){var a=this,b=this.config,e=new g(this.list,b),f=new d(b),i=new c("div","comments-widget");this.element.appendChild(i);var j=new c("div","input-container");j.append(f),i.appendChild(j),j=new c("div","comment-list-container"),j.appendChild(e),i.appendChild(j),h(i,function(c){var d=c.target.value;"function"==typeof b.submitAPIHandler?b.submitAPIHandler({content:d}).then(function(b){a.list.unshift(b),a.destroy(),a.render()}):console.log("Don't know what to do with this comment")})},a.commentList=function(a,c,d){return new b(a,c,d)}}(window),function(a){function b(a){var b=Math.floor((new Date-a)/1e3),c=Math.floor(b/31536e3);if(c>1)return c+" years ago";if((c=Math.floor(b/2592e3))>1)return c+" months ago";if((c=Math.floor(b/86400))>1)return c+" days ago";if((c=Math.floor(b/3600))>1)return c+" hours ago";if((c=Math.floor(b/60))>1)return c+" minutes ago";var d=Math.floor(b);return d<5?"Just now":d<15?"a few seconds ago":d+" seconds ago"}a.commentListUtils={timeSince:b}}(window);